{% extends "theme/base.html" %}
{% load i18n %}
{% block title %}{{ instance.name }} on {{ instance.cluster.description }}{% endblock %}
{% block extrahead %}
<style type="text/css">
		#toolbar {
		padding: 10px 4px;
	}
	li{
		list-style: none;
	}
</style>
<script type="text/javascript">
var polltimer;
var timer = 2500;
var load_data = function () {
        $.ajax({
            type: 'GET',
            url: '{% url instance-poll cluster.slug instance.name %}'+"?_="+new Date().getTime(),
            dataType: 'html',
            success: function(data) {
                $('#actions_container').html(data);
				if ($('#show_no_actions').size()==1){
					$('#conf_form').hide();
				}else if ($('#show_no_actions').size()==0){
					$('#conf_form').show();
				}
				$("#status").html($("#instance_status").html());
                polltimer = setTimeout(load_data, timer);
            }
        });
    }
$(function() {
    load_data();
});

</script>
{% endblock %}
{% block homepage %}class="active"{% endblock %}
{% block homepagetop %}class="active"{% endblock %}
{% block crumbs %}
	    			<li><a href="{% url user-instances %}">{% trans "Home" %}</a><span class="divider">/</span></li>
	    			<li class="active">{{ instance.name }}</li>
	    		{% endblock %}

{% block content %}
{% load disksizes %}



<div class="span6 main-content">

    <div class="row-fluid">
        <div class="row-fluid">
        	<h2>{{ instance.name }}</h2>
            <table class="table">
                <thead>
                    <tr>
                      <th class="span12" colspan="2">Details</th>
                    </tr>
                </thead>
                <tbody>
					<tr><td class="">{% trans "Status" %}</td><td id="status"></td></tr>
					<tr><td class="">{% trans "Cluster" %}</td><td>{{ instance.cluster.description }}</td></tr>
					<tr><td class="">{% trans "Memory" %}</td><td>{{ instance.beparams.memory|memsize }}</td></tr>
					<tr><td class="">{% trans "CPUs" %}</td><td>{{ instance.beparams.vcpus }}</td></tr>
					<tr><td class="">Hard disk{{ instance.disk_sizes|pluralize }}</td><td>{{ instance.disk_sizes|disksizes|join:", " }}</td></tr>
					<tr><td class="">{% trans "Network cards" %}</td><td>{{ instance.nic_macs|length }}</td></tr>
					<tr><td class="">MAC address{{ instance.nic_macs|pluralize:"es" }}</td><td>{{ instance.nic_macs|join:", " }}</td></tr>
					{% if instance.nic_ips %}
					<tr><td class="">IP address{{ instance.nic_ips|pluralize:"es" }}</td><td>{{ instance.nic_ips|join:", " }}</td></tr>
					{% endif %}
					<tr><td class="">{% trans "Created on" %}</td><td>{{ instance.ctime|date }}</td></tr>
					<tr><td class="">{% trans "Last modified" %}</td><td>{{ instance.mtime|date }}</td></tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<div class="span6 sidebar">
        <div class="row-fluid">
    <div class="row-fluid">
    <h2>{% trans "Configuration Options" %}</h2>
        <form method="post" align="center" id="conf_form" class="form">
{% csrf_token %}
<table class="table">
<thead>
                    <tr>
                      <th class="span12" colspan="2">{% trans "Configuration" %}</th>
                    </tr>
                </thead>
{{ configform.as_table }}
<tr><td colspan="2" style="text-align:center; padding: 5px;" >
<button class="btn btn-primary" id="update" type="Submit" value="Update" />Update</button></td></tr>

</table>

</form>
        </div>
        </div>
       
       <div class="row-fluid">
    <div class="row-fluid">
       <table class="table">
       <thead>
                    <tr>
                      <th class="span12" colspan="2">{% trans "Actions" %}</th>
                    </tr>
                </thead>
<tr>
	<td id="actions_container">&nbsp;</td>
		<!-- Here a setTimeout jquery script populates the instance control every 5 seconds -->
</tr>
</table>
</div>
</div>
 
       
        </div>



{% endblock %}
